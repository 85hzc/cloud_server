

var mysql   = require('mysql');
var db = require('db');
var client = mysql.createConnection(db.mysql);
 
client.connect();




     


//'6', '2017061240128204', 'http://10.6.61.146:9999/6', NULL, NULL, NULL, '0'
//'6', '20170612343435', 'http://10.6.61.10:10002/6', NULL, NULL, NULL, '0'



          var selectStr="SELECT * FROM dev_live_resource WHERE resourceId='6' AND deviceId='20170612343435' ";
        console.log(selectStr);
        client.query(selectStr,function(err,results){
            if (err) {
                console.error(err.stack);
                return;
            }

            a=results[0].currentSlaveCnt;
            b=a-1;
            console.log(b);
            console.log(a);

            var updateStr="UPDATE dev_live_resource SET currentSlaveCnt='"+b+"' WHERE resourceId='6' AND deviceId='20170612343435' ";
                client.query(updateStr,function(err,result2){





                });



        });

         /* //var selectStr = "DELETE FROM transfer_resource WHERE deviceId='"+ deviceId + "' AND resourceId='"+ resId + "';";
         var updateStr=" UPDATE transfer_resource SET online='0' WHERE deviceId='" + deviceId + "' AND src='"+src +"'; ";

        console.log(updateStr);
        client.query(updateStr, function(err, result) {
            if (err) {
                console.error(err.stack);
                return;
            }

            var results= {
                type: 4,
                ret: 0

            };

             console.log(JSON.stringify(results));
            res.send(JSON.stringify(results));
           
              
        });

     
    }*/
    