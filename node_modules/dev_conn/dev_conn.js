var connId=1;
var sockets = {};
var devConnMap = {};

function newConnection(socket) {
    var skInfo = {};
    skInfo.sk=socket;
    skInfo.devList = new Array();
    sockets[connId] = skInfo;
    return connId++;
}

function releaseConnection(connId) {
    delete sockets[connId];
}

function updateDevInfo(devId, connId) {
    devConnMap[devId] = connId; 
    sockets[connId].devList.push(devId);
}

function getDevListByConnId(connId) {
    return sockets[connId].devList;
}

function getSocketByDevId(devId) {
    var connectionId = devConnMap[devId];
    if(typeof(connectionId) == 'undefined') {
        console.log("Can't find connId for devId" + devId);
        return -1;
    }
    return sockets[connectionId].sk;
}

exports.newConnection = newConnection;
exports.releaseConnection = releaseConnection;
exports.updateDevInfo = updateDevInfo;
exports.getDevListByConnId = getDevListByConnId;
exports.getSocketByDevId = getSocketByDevId;
