module.exports.message_handle = socket_arr_add;


function message_handle(req, res)
{      
    
    var message = req.weixin;

    console.log(message);  
    var msgType = message.MsgType;

    var eventKey = message.EventKey;

    var weixin_user = message.FromUserName;

    console.log(msgType);

    if ( "device_event" == msgType)
    {       
        console.log("Enter device_event");
    }

    else if ( "event" == msgType)
    {
	if (("query" == eventKey)
	    || ("turn_on" == eventKey)
	    || ("turn_off" == eventKey)
	   )
	{
            console.log("Enter weixin");
            req.socket.id = weixin_user;
            socket_arr.socket_arr_add(weixin_socket_arr, req.socket, weixin_user);
            req.socket.on('close', weixin_close_socket);
        }
    }

//    if ()
    {
    }
}
